### 얕은 복사와 깊은 복사란

객체지향 언어(나의 경우에는 Java를 학습하고 있다.)를 학습하다 보면 다음과 같은 용어들을 마주하게 된다. 객체를 선언하고 값을 할당한 뒤 이를 같은 타입의 다른 변수에 할당하는 행위는 과연 어떤
배경을 갖고 있을까?

먼저 **객체를 선언하고 값을 할당하는 행위**는 **메모리에 공간을 하나 만들고 해당 공간에 값을 할당하는 것**으로 이해할 수 있다. 그리고 우리는 해당 객체의 메모리 주소(= 객체의 참조값)을 통해서 해당
객체의 값을 알 수 있는 것이다. 그렇다면 '다른 객체(B)'를 선언하고 '기존에 선언하고 값을 초기화한 객체(A)'를 할당한다면 'B'에는 'A'의 메모리 주소(= 객체의 참조값)이 초기화되는 것일까? 아니면 '
A'의 값이 초기화되는 것일까?

이는 개발자가 어떤 방식으로 'B'객체에 값을 초기화 했는지에 따라 정답이 달라진다. 만약 개발자가 B에 A를 초기화하는 행위를 했다면 B에는 A의 메모리 주소(= 객체의 참조값)이 복사된다. 다시 말해서 **B와
A는 같은 메모리 주소를 갖는 것이다.** 그렇기 때문에 A의 값이 바뀌거나 B의 값이 바뀌면 상호간에 영향을 미치게 된다. 아래의 코드를 참고해 보자.

```Java
ArrayList<Integer> original = new ArrayList<>(Arrays.asList(1, 2, 3));
ArrayList<Integer> shallowCopy = original; // original의 주소값을 복사

original.set(0,100); // original이 [100, 2, 3]으로 변경되고 같은 주소값을 갖는 shallowCopy도 같은 변경이 적용된다.
System.out.print(shallowCopy); // [100, 2, 3]이 출력된다.
```

위와 같은 복사를 **얕은 복사(Shallow copy)** 라고 한다.

개발자가 'B'에 'A'의 값을 초기화하는 행위를 했다면 이는 'B'는 새로운 메모리 주소를 갖고 그 주소에 'A'의 값을 똑같이 초기화 한다. 다시 말해서 'A'와 'B'는 서로 다른 메모리 주소를 갖고 값만
똑같은 상태이다, 마치 쌍둥이와 같다고 할 수 있다. 이러한 이유로 A의 값을 변경해도 B의 값에는 영향을 미치지 않는다. 아래의 코드를 참고해 보자.

```Java
ArrayList<Integer> original = new ArrayList<>(Arrays.asList(1, 2, 3));
ArrayList<Integer> deepCopy = new ArrayList<>(original); // 새로운 객체를 만들고 original의 값을 전달해줌

original.set(0,100);
System.out.print(deepCopy); // [1, 2, 3]이 출력
```
위와 같은 복사를 **깊은 복사(Deep copy)** 라고 한다.

### 더 알아보기

얕은 복사와 깊은 복사가 어떤 방식으로 이루어지는지 알아보았고 그렇기 때문에 야기되는 일들에 대해서도 이해했다. 얕은 복사와 깊은 복사의 차이를 주의하며 사용해야 하는 경우는 객체가 **가변 객체(mutable
object)인지 불변 객체(immutable object)** 인지에 따라 달라진다.

먼저 가변 객체의 경우 하나의 메모리 주소에서 값을 변경할 수 있는 객체를 의미한다. 이러한 가변 객체에 얕은 복사를 할 경우 개발자가 의도하지 않게 데이터의 정합성이 깨질 우려가 있다. 불변 객체의 경우 하나의
메모리 주소에서 값을 변경할 수 없는 객체를 의미하는데, 이러한 불변 객체의 특성에 따라 얕은 복사를 하더라도 문제가 되지 않는다. 문제가 되지 않는 이유는 불변 객체에 얕은 복사를 했을 경우 진행되는 흐름을 보면
알 수 있다.

```Java
String a = "Hello";
String b = a; // 불변 객체에 얕은 복사를 실행, a와 b는 같은 메모리 주소를 가리키고 있음

a ="World"; // a의 값을 변경하였는데 String은 불변 객체 이므로 기존의 메모리 주소 대신에 새로운 메모리 주소를 갖게 됨  
```

Java에서는 String Pool이라는 개념을 이용해 불변 객체가 같은 값을 가질때를 효율적으로 처리한다(메모리를 효율적으로 사용한다.) -> [[String Pool]]